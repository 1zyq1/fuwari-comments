name: Comment Notification
on:
  discussion_comment:
    types: [created]
    
jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Send Email Notification via QQ Mail
        uses: dawidd6/action-send-mail@v3
        with:
          # QQé‚®ç®±SMTPæœåŠ¡å™¨é…ç½®
          server_address: smtp.qq.com
          server_port: 465
          username: ${{ secrets.QQ_EMAIL_USER }}      # QQé‚®ç®±åœ°å€
          password: ${{ secrets.QQ_EMAIL_PASS }}      # QQé‚®ç®±æˆæƒç ï¼ˆä¸æ˜¯ç™»å½•å¯†ç ï¼‰
          # é‚®ä»¶å†…å®¹
          subject: "ğŸ“ æ–°è¯„è®ºé€šçŸ¥ - ${{ github.event.discussion.title }}"
          to: ${{ secrets.NOTIFY_EMAIL }}             # æ¥æ”¶é‚®ç®±
          from: GitHub Discussions Bot
          html_body: |
            <!DOCTYPE html>
            <html>
            <head>
              <meta charset="utf-8">
              <style>
                body { font-family: "Microsoft YaHei", Arial, sans-serif; line-height: 1.6; color: #333; }
                .container { max-width: 600px; margin: 0 auto; background: #fff; }
                .header { background: linear-gradient(135deg, #12c2e9, #c471ed, #f64f59); color: white; padding: 20px; text-align: center; }
                .content { padding: 25px; }
                .info-box { background: #f8f9fa; border-radius: 8px; padding: 15px; margin: 15px 0; }
                .comment-box { background: #fff; border: 1px solid #e1e4e8; border-left: 4px solid #0366d6; padding: 15px; margin: 15px 0; }
                .button { 
                  display: inline-block; 
                  background: linear-gradient(135deg, #12c2e9, #c471ed);
                  color: white; 
                  padding: 12px 25px; 
                  text-decoration: none; 
                  border-radius: 25px; 
                  font-weight: bold;
                  margin: 15px 0;
                  box-shadow: 0 4px 15px rgba(18, 194, 233, 0.3);
                }
                .footer { 
                  margin-top: 30px; 
                  padding-top: 15px; 
                  border-top: 1px solid #eee; 
                  color: #666; 
                  font-size: 12px; 
                  text-align: center;
                }
              </style>
            </head>
            <body>
              <div class="container">
                <div class="header">
                  <h1>ğŸ’¬ æ‚¨æœ‰æ–°çš„è¯„è®ºæ¶ˆæ¯</h1>
                </div>
                
                <div class="content">
                  <div class="info-box">
                    <p>ğŸ¯ <strong>æ–‡ç« æ ‡é¢˜ï¼š</strong>${{ github.event.discussion.title }}</p>
                    <p>ğŸ‘¤ <strong>è¯„è®ºç”¨æˆ·ï¼š</strong>${{ github.event.comment.user.login }}</p>
                    <p>ğŸ• <strong>è¯„è®ºæ—¶é—´ï¼š</strong>${{ github.event.comment.created_at }}</p>
                  </div>
                  
                  <div style="margin: 20px 0;">
                    <p><strong>ğŸ“ è¯„è®ºå†…å®¹ï¼š</strong></p>
                    <div class="comment-box">
                      ${{ github.event.comment.body }}
                    </div>
                  </div>
                  
                  <div style="text-align: center;">
                    <a href="${{ github.event.comment.html_url }}" class="button">
                      ğŸ”— ç‚¹å‡»æŸ¥çœ‹å®Œæ•´è¯„è®º
                    </a>
                    <p style="color: #666; font-size: 13px; margin-top: 5px;">
                      å¦‚æœæŒ‰é’®æ— æ³•ç‚¹å‡»ï¼Œè¯·å¤åˆ¶é“¾æ¥ï¼š<br>
                      <span style="color: #0366d6; word-break: break-all;">${{ github.event.comment.html_url }}</span>
                    </p>
                  </div>
                  
                  <div class="footer">
                    <p>æ­¤é‚®ä»¶ç”± GitHub Actions è‡ªåŠ¨å‘é€</p>
                    <p>ğŸ“§ å‘é€é‚®ç®±ï¼š${{ secrets.QQ_EMAIL_USER }}</p>
                    <p>â° å‘é€æ—¶é—´ï¼š${{ fromJSON('"' + steps.date.outputs.date + '"') }}</p>
                  </div>
                </div>
              </div>
            </body>
            </html>
