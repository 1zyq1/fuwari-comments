name: è¯„è®ºé€šçŸ¥ç³»ç»Ÿ
on:
  discussion_comment:
    types: [created]
    
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è¿è¡Œ

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: è·å–å½“å‰æ—¶é—´
        id: date
        run: echo "date=$(date '+%Yå¹´%mæœˆ%dæ—¥ %H:%M:%S')" >> $GITHUB_OUTPUT
        
      - name: å‘é€é‚®ä»¶é€šçŸ¥
        uses: dawidd6/action-send-mail@v3
        with:
          # QQé‚®ç®±é…ç½®
          server_address: smtp.qq.com
          server_port: 465
          username: ${{ secrets.QQ_EMAIL_USER }}
          password: ${{ secrets.QQ_EMAIL_PASS }}
          
          # é‚®ä»¶æ¥æ”¶é…ç½®
          subject: "ğŸ’¬ æ–°è¯„è®ºé€šçŸ¥ - ${{ github.event.discussion.title }}"
          to: ${{ secrets.NOTIFY_EMAIL }}
          from: "åšå®¢è¯„è®ºæœºå™¨äºº <${{ secrets.QQ_EMAIL_USER }}>"
          
          # é‚®ä»¶å†…å®¹ï¼ˆHTMLæ ¼å¼ï¼‰
          html_body: |
            <!DOCTYPE html>
            <html>
            <head>
              <meta charset="utf-8">
              <style>
                body { font-family: 'Microsoft YaHei', sans-serif; line-height: 1.6; color: #333; }
                .container { max-width: 600px; margin: 0 auto; padding: 20px; }
                .header { background: #0366d6; color: white; padding: 20px; text-align: center; }
                .content { padding: 20px; background: #f6f8fa; }
                .button { 
                  display: inline-block; 
                  background: #0366d6; 
                  color: white; 
                  padding: 10px 20px; 
                  text-decoration: none; 
                  border-radius: 5px; 
                }
              </style>
            </head>
            <body>
              <div class="container">
                <div class="header">
                  <h1>ğŸ’¬ æ–°è¯„è®ºé€šçŸ¥</h1>
                </div>
                <div class="content">
                  <p><strong>æ–‡ç« ï¼š</strong>${{ github.event.discussion.title }}</p>
                  <p><strong>ç”¨æˆ·ï¼š</strong>${{ github.event.comment.user.login }}</p>
                  <p><strong>æ—¶é—´ï¼š</strong>${{ steps.date.outputs.date }}</p>
                  <hr>
                  <p><strong>è¯„è®ºå†…å®¹ï¼š</strong></p>
                  <div style="background: white; padding: 15px; border-left: 4px solid #0366d6;">
                    ${{ github.event.comment.body }}
                  </div>
                  <br>
                  <a href="${{ github.event.comment.html_url }}" class="button">
                    æŸ¥çœ‹è¯„è®º
                  </a>
                  <p style="margin-top: 20px; color: #666; font-size: 12px;">
                    æ­¤é€šçŸ¥ç”± GitHub Actions è‡ªåŠ¨å‘é€
                  </p>
                </div>
              </div>
            </body>
            </html>
